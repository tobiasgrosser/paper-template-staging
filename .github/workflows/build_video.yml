# This is a basic workflow to help you get started with Actions

name: Create Video

# Controls when the action will run. Triggers the workflow on push or pull request 
# events but only for the master branch
on: [push]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    - uses: FranzDiebold/github-env-vars-action@v1.2.1
    - name: Install GitHub Release Downloader
      run: sudo npm install -g github-release-downloader

    - name: Install FFMPEG
      run: sudo apt install ffmpeg

    - name: Install ImageMagick
      run: sudo apt install imagemagick

    - name: Download artefacts
      run: grd --token ${{ secrets.GITHUB_TOKEN }} --owner ${GITHUB_REPOSITORY_OWNER} --repository ${GITHUB_REPOSITORY_NAME}	 --timeout 3000 --parallel 20

    - name: Create Video
      run: tools/create-video.py
